{% if site.google_analytics_ga4 %}

      <!--
            I don't want to load the Google script in all cases. It should only be
            loaded if the user has said "YES" to cookies. So instead of a script-tag
            I use the JavaScript code below.
            See: https://stackoverflow.com/questions/14521108/dynamically-load-js-inside-js
      -->

      <!--<script async src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics_ga4 }}"></script>-->

      <script>

            if(consentGiven()) {

                  const script = document.createElement('script');
                  script.src = "https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics_ga4 }}";
                  document.head.appendChild(script);

                  window.dataLayer = window.dataLayer || [];
                  function gtag(){dataLayer.push(arguments);}
                  gtag('js', new Date());
                  gtag('config', "{{ site.google_analytics_ga4 }}", { 'anonymize_ip': true });
            }

      </script>

{% endif %}
